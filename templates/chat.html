<!DOCTYPE html>
<html>
   <head lang="en">
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Chatbot</title>
   <!--     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
        <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
  <!--	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script> -->
	<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script> 
        <link href="{{ url_for('static', filename='styles/style.css') }}" type="text/css" rel="stylesheet" />
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script> -->
	<script src="{{ url_for('static', filename='js/Chart.min.js') }}"></script>
	<!--tensorflow js -->
  	<script src="{{ url_for('static',filename='js/face-api.js') }}"></script>
    	<script src="{{ url_for('static',filename='js/commons.js') }}"></script>
 	<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>-->
        <!--<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.14.1/dist/tf.min.js"></script>-->
	<script src="{{ url_for('static', filename='js/tf.min.js') }}"></script>
       	<!--<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">-->
        <link href="{{ url_for('static', filename='styles/bootstrap.min.css') }}" type="text/css" rel="stylesheet" />
      	<!--<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"rel="stylesheet">-->
        <link href="{{ url_for('static', filename='styles/font-awesome.min.css') }}" type="text/css" rel="stylesheet" />
      	<link href="{{ url_for('static',filename ='styles/style.css') }}" rel="stylesheet">
      <style type="text/css">

        .fixed-panel {
        min-height: 170px;
        max-height:170px;
        background-color: white;
        color: black;
        overflow: auto;
        }
	.modal-backdrop {
	  z-index: 0;
	}

        .media-list {
        overflow: auto;
        clear: both;
        display: table;
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: normal;
        line-break: strict;
        color:black;
        }
        .panel {
        margin-bottom: 20px;
        background-color: white;
        border: 6px solid transparent;
        border-radius: 25px;
        -webkit-box-shadow: 0 1px 1px rgba(0,0,0,.05);
        box-shadow: 0 1px 1px rgba(0,0,0,.05);
        }
        .panel-info {
        border-color: white;
        }
        .panel-info>.panel-heading {
        color: black;
        background-color: white;
        border-color: #0c2735;
        }
        .panel-footer {
        padding: 10px 15px;
        background-color: white;
        border-top: 1px solid #0c2735;
        border-bottom-right-radius: 3px;
        border-bottom-left-radius: 3px
        }

        #demotext {
        color:black;
        text-align:center;

        }
        #container2 {
        margin: 0px auto;
        width: 500px;
        height: 375px;
        border: 10px #333 solid;
        }
        #videoElement {
        width: 105%;
        height: 36%;
        background-color: #666;
        }
    #overlay {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 10;
    background-color: transparent;

}


      </style>
   </head>
   <body>
      <div class="container-fluid background-color:white;">
         <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
               <div class="navbar-header">
                  <a class="navbar-brand" href="#">Interview Bot</a>
               </div>
               <ul class="nav navbar-nav">
                  <li class="active"><a href="#">Welcome</a></li>
                  <li><a></a></li>
<li><button type="button" class="btn btn-success navbar-btn " id="timerText">0:00 sec</button></li>
               </ul>

		<ul class="nav navbar-nav navbar-right">

  			<li><button type="button" class="btn btn-success navbar-btn " id="startInterviewButton">Start Interview</button></li>
			<li><a></a></li>
   			<li><form id="finishForm" action="/generate" method="post">			
			<input type="text" id="iTime" name="iTime" value="hidden value" hidden/>			
			<button type="submit" class="btn btn-danger navbar-btn" id="finishInterviewButton" disabled>
			Finish Interview
			</button>
			</form>
			</li>
			<li><a></a></li>
		</ul>


            </div>
         </nav>
       </div><!--navbarend -->
       <br/><br/><br/>
       <div class="container-fluid">
         <div class="row">
            <!-- video -->
            <div class="container2 col-md-4 ">
		<div  style="position: relative; margin-left:3%;" >
<div class="row">
<div class="col">
       <video onplay="onPlay(this)" id="inputVideo" autoplay muted></video>
</div>
<div class="col">
            <canvas id="overlay" />
</div>
            <!--<canvas id='canvas' />-->
</div>
		</div>
            </div>
	   <!-- interviewer -->
            <div class="container2 col-md-4 panel panel-warning">
		<div class="panel-body">
               		<img src="{{url_for('static', filename='interview-stare.jpg')}}" id="videoElement" />
		</div>
            </div>
	   <!-- chatbot -->
            <div class="col-md-4">
               <div id="chatPanel" class="panel panel-info">
                  <div class="panel-body fixed-panel">
                     <ul class="media-list">
                     </ul>
                  </div>
                  <div class="panel-footer">
                     <form method="post" id="chatbot-form" autocomplete="off">
                        <textarea class="form-control" placeholder="Enter Message" name="messageText" id="messageText" autofocus disabled required/></textarea>

                        <br/>
                        <div class="input-group">
                           <span class="input-group-btn">
                           <button class="btn btn-danger" type="button" id="chatbot-form-btn-clear-input" disabled>Clear input</button>
                           <button class="btn btn-success" type="button" id="chatbot-form-btn" disabled>Submit Your Answer</button>
                           <button class="btn btn-warning" type="button" id="chatbot-form-btn-clear" disabled>Clear</button>
                           <button class="btn btn-info" type="button" id="chatbot-form-btn-voice" disabled>Voice</button>
                           </span>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
         <div class="row"><!--row-->
    	   <div class="col-lg-4">
		<canvas id="myChart2" width="400" height="200"></canvas>
	    </div>
            <div class="col-lg-4">
              
			<canvas id="myChart" width="400" height="170"></canvas>
		
            </div>
        
            <div class="col-lg-4">
               <div class="panel panel-default">
  		<div class="panel-heading">Text Analysis</div>
  		<div class="panel-body">
           <!-- <div class="row">
                <label for="time">Time:</label>
                <input disabled value="-" id="time" type="text" class="bold">
            </div> -->
            <div class="row">
                <label for="fps">Estimated Fps:</label>
                <input disabled value="-" id="fps" type="text" class="bold">
            </div>
</div>
		</div>
            </div>
         </div><!--end row -->



  </div>
     <!-- <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
      <script>
         var exports = {};
      </script>
     <!-- <script src="https://unpkg.com/speech-to-text@0.7.4/lib/index.js"></script>-->
      <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>-->

<script src="{{ url_for('static', filename='js/emotion.js') }}"></script>

<script>

//runs tensorflow in browser
async function run() {

const Model_url = "{{url_for('static',filename='js/models/tiny_face_detector_model-weights_manifest.json')}}"
await faceapi.loadTinyFaceDetectorModel(Model_url)
modelLoaded = true

navigator.mediaDevices.getUserMedia(constraints)  //change global constraints for height and width
                .then(successCallback)
                .catch(errorCallback);
//passing video id
onPlay($('#inputVideo').get(0))
	   //hiding loader
           // $('#loader').hide()
        }
function loadModelFunction(){
loadModel("{{ url_for('static',filename='model.json') }}")  //https://js.tensorflow.org/api/0.15.3/#loadModel
}
</script>

<script src="{{ url_for('static', filename='js/index.js') }}"></script>

<!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" id="instruction_heading">Start Interview - Instructions</h4>
        </div>
        <div class="modal-body"  id="instruction_body">
	<h3>Welcome to Interview Bot</h3>
	<h5> Interviews required practise and this project aims to prepare you for the same.</h5>
	<div style="color:green">
	<ul>
	<li>The Left side of the screen panel have your live stream</li>
	<li>The Center side of the screen is the interviewer</li>
	<li>The Righ side of the screen have the chatbot which will take your interview</li>
	<li>The Bottom of the screen have the various analysis which are done your reponse to the question</li>
	</ul>
	</div>
        <p>Before starting the interview, please read the following instructions</p>
	<ul>
	<li>To begin interview speak "<b><span style="color:red">START INTERVIEW</span></b>"</li>
	<li>After speaking your answer click on the <b>SEND</b> button</li>
	<li>If the bot continously asks the same question or you want to skip the question, then speak "<b><span style="color:red">NEXT QUESTION</span></b>"</li>
	</ul>


        </div>
        <div class="modal-footer">
<p style="color:green">All the best !!</p>
          <button type="button" class="btn btn-info" data-dismiss="modal" id="continueInterview">Continue</button>
        </div>
      </div>
      
    </div>
  </div>
<!-- end modal -->

<!-- Modal -->
  <div class="modal fade" id="finishModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" id="instruction_heading">Start Interview - Instructions</h4>
        </div>
        <div class="modal-body"  id="instruction_body">
	<h3>Are you sure you want to finish the interview?</h3>
	
	</ul>


        </div>
        <div class="modal-footer">
<p style="color:green">Finish Interview</p>
          <button type="button" class="btn btn-warning" data-dismiss="modal" id="finsihModalButton">Finish</button>
        </div>
      </div>
      
    </div>
  </div>
<!-- end modal -->
   </body>
</html>
